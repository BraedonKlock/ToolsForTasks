package ToolsForTasks;


import java.io.*;
import java.util.*;

public class JobList {
	 static Scanner scanner = new Scanner(System.in);
	    static List<Job> jobList = new ArrayList<>();

	    public static void addJob() {
	        System.out.println("Enter job name:");
	        String name = scanner.nextLine();

	        System.out.println("Enter job description:");
	        String description = scanner.nextLine();

	        Job job = new Job(name, description);

	        while (true) {
	            System.out.println("Add a tool? (yes/no):");
	            String response = scanner.nextLine();

	            if (response.equalsIgnoreCase("no")) break;

	            System.out.println("Tool name:");
	            String toolName = scanner.nextLine();

	            System.out.println("Quantity:");
	            String quantity = scanner.nextLine();

	            Tool tool = new Tool(toolName, quantity);
	            job.addTool(tool);
	        }

	        jobList.add(job);
	        System.out.println("Job added!\n");
	    }

	    public static void listJobs() {
	        for (Job job : jobList) {
	            System.out.println(job);
	        }
	    }
	    
	    public static void saveToFile() {
	        try (FileWriter writer = new FileWriter("jobs.csv")) {
	            for (Job job : jobList) {
	                StringBuilder line = new StringBuilder();
	                line.append(job.getName()).append(",");
	                line.append(job.getDescription()).append(",");

	                List<Tool> tools = job.getTools();
	                for (int i = 0; i < tools.size(); i++) {
	                    Tool tool = tools.get(i);
	                    line.append(tool.getName()).append(":").append(tool.getQuantity());
	                    if (i < tools.size() - 1) {
	                        line.append("|"); // delimiter between tools
	                    }
	                }

	                writer.write(line.toString() + "\n");
	            }

	            System.out.println("Jobs saved to file.");
	        } catch (IOException e) {
	            System.out.println("Error saving file: " + e.getMessage());
	        }
	    }
	    
	    public static void loadFromFile() {
	        jobList.clear(); // in case you reload during runtime

	        try (BufferedReader br = new BufferedReader(new FileReader("jobs.csv"))) {
	            String line;
	            while ((line = br.readLine()) != null) {
	                String[] parts = line.split(",", 3); // only 3 parts: name, description, tools
	                if (parts.length < 3) continue;

	                Job job = new Job(parts[0], parts[1]);

	                String[] toolData = parts[2].split("\\|");
	                for (String toolEntry : toolData) {
	                    String[] toolParts = toolEntry.split(":");
	                    if (toolParts.length == 2) {
	                        job.addTool(new Tool(toolParts[0], toolParts[1]));
	                    }
	                }

	                jobList.add(job);
	            }

	            System.out.println("Jobs loaded from file.");
	        } catch (IOException e) {
	            System.out.println("Error loading file: " + e.getMessage());
	        }
	    }
}
//	 private static List<Job> JobList = new ArrayList<>();
//	    private static final String FILE_NAME = "jobs.csv";
//	    static Scanner scanner = new Scanner(System.in);
//
//	    public JobList() {
//	        loadFromFile();
//	    }
//
//	    public static void addJob() {
//	    	System.out.println("Name: ");
//	    	String name = scanner.nextLine();
//	    	System.out.println("Description: ");
//	    	String description = scanner.nextLine();
//	    	
//	  
//	    	System.out.print("Add tool: ");
//	    	String toolName = scanner.nextLine();
//	    	System.out.println("Quantity: ");
//	    	String quantity = scanner.nextLine();
//	 
//	    	
//	    	Tool tool = new Tool(toolName, quantity);
//	    	
//	        JobList.add(new Job(name, description, tool ));
//	        saveToFile();
//	    }
//
//	    public static void editJob() {
//	      
//	    }
//
//	    public static void deleteJob() {
//	    }
//
//	    public static void searchJob() {
//	    }
//
//	    public static void listJobs() {
//	    	if (JobList.isEmpty()) {
//	    		System.out.println("Job list is empty");
//	    	}
//	        for (Job job : JobList) {
//	            System.out.println("Name: " + Job.getName() + "\nDescription: " + Job.getDescription() + "\nJOB TOOLS \n" + Job.getTool());
//	        }
//	    }
//
//	    static void loadFromFile() {
//	        try (BufferedReader br = new BufferedReader(new FileReader(FILE_NAME))) {
//	            String line;
//	            while ((line = br.readLine()) != null) {
//	                String[] data = line.split(",");
//	                JobList.add(new Job(data[0].trim(), data[1].trim(), new Tool(data[2].trim(), data[3].trim())));
//
//	            }
//	        } catch (IOException ignored) {
//	        }
//	    }
//
//	    private static void saveToFile() {
//	    	 String fileName = "jobs.csv";
//	    	 try (FileWriter writer = new FileWriter(fileName)) {
//	    		    for (Job job : JobList) {
//	    		        Tool tool = job.getTool(); // get the tool from the job
//
//	    		        writer.append(job.getName()).append(",");
//	    		        writer.append(job.getDescription()).append(",");
//	    		        writer.append(tool.getName()).append(",");
//	    		        writer.append(tool.getQuantity()).append("\n"); // no comma after last field
//	    		    }
//	    		    System.out.println("Jobs saved successfully.");
//	    		} catch (IOException e) {
//	    		    System.out.println("Error saving file: " + e.getMessage());
//	    		}
//	    }
//}
